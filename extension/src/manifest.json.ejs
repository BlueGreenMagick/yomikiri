{
  "manifest_version": <%- v2 ? 2 : 3 %>,
  "name": "Yomikiri",
  "version": "0.0.1",
  "description": "Web extension to view definition for Japanese words and add to Anki.",
  "author": "BlueGreenMagick",
  "icons": {
    "48": "res/images/icon48.png"
  },
  "content_scripts": [
    {
      "all_frames": true,
      "js": [
        "content.js"
      ],
      "matches": [
        "http://*/*",
        "https://*/*",
        "file:///*"
      ]
    }
  ],
  "background": {
<% if (firefox || v2) { -%>
    "scripts": [
      "background.js"
    ],
    "persistent": false,
<% } else { -%>
    "service_worker": "background.js",
<% } -%>
    "type": "module"
  },
<% if (v2) { -%>
  "browser_action": {
<% } else { -%>
  "action": {
<% } -%>
    "default_icon": {
      "48": "res/images/icon48.png"
    },
    "default_title": "Yomikiri",
    "default_popup": "popup.html"
  },
  "options_ui": {
    "page": "options.html",
    "open_in_tab": true
  },
<% if (ios) { -%>
  "declarative_net_request": {
    "rule_resources" : [{
      "id": "redirect_rule",
      "enabled": true,
      "path": "res/redirect_rules.json"
    }]
  },
  "web_accessible_resources": [
    {
      "resources": [
        "x-callback.html"
      ],
      "matches": [
        "<all_urls>"
      ]
    }
  ],
<% } -%>
  "permissions": [
<% if (ios) { -%>
    "nativeMessaging",
    "declarativeNetRequest",
<% } -%>
    "storage"
  ],
  "optional_permissions": [],
  "host_permissions": [
    "<all_urls>"
  ],
<% const csp = "script-src 'self' 'wasm-unsafe-eval'; object-src 'self'"; -%>
<% if (v2) { -%>
  "content_security_policy": "<%- csp %>"
<% } else { -%>
  "content_security_policy": {
    "extension_pages": "<%- csp %>"
  }
<% } -%>
}